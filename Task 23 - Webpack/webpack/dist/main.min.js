(()=>{"use strict";(()=>{class t{constructor(t){this._date=t._date,this._time=t._time,this._humidity=t._humidity,this._pressure=t._pressure,this._windSpeed=t._windSpeed,this._windDirection=t._windDirection,this._icon=t._icon,this._temp=t._temp,this._feelsLike=t._feelsLike,this._desc=t._desc,this._city=t._city,this._cityForm=t._cityForm,this._localStorageKeyName=t._localStorageKeyName,this._preloader=t._preloader,this.city=void 0}init(){this.loadUsersCity(),this.getUsersCity(),this.getCity()}loadUsersCity(){const t=JSON.parse(localStorage.getItem(this._localStorageKeyName));t&&(this.city=t,this.getWeatherData())}togglePreloader(){this._preloader.toggleClass("show")}getUsersCity(){this.city||axios.create().get("https://extreme-ip-lookup.com/json/?key=xcpOqpa0tcmKcQKbXGdC").then((t=>{this.city=t.data.city,localStorage.setItem(this._localStorageKeyName,JSON.stringify(this.city)),this.getWeatherData()})).catch((()=>{console.log("Unable to get user's city, the city is set to Lviv by default."),this.city="Lviv",this.getWeatherData()}))}getCity(){this._cityForm.on("submit",(t=>{t.preventDefault();const e=this._cityForm.find(".js--city-input");e.val()&&(this.city=e.val(),this.getWeatherData(),t.currentTarget.reset())}))}getWeatherData(){this.togglePreloader(),axios.create().get(`https://api.openweathermap.org/data/2.5/weather?q=${this.city}&units=metric&APPID=5d066958a60d315387d9492393935c19`).then((t=>{this.displayData(t.data),this.togglePreloader()})).catch((()=>{console.log("ERROR, 404 - Not Found"),this._city.html("404 - Not Found"),this.displayData(void 0),this.togglePreloader()}))}displayDate(t){if(t){const t=new Date,e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()];let i=t.getHours();const s=t.getMinutes(),a=t.getDate();let h=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t.getDay()-1];const r=`${i}:${+s>10?s:"0"+s}`;this._date.html(`${a}&nbsp;&zwnj;&nbsp;${e}&nbsp;&zwnj;&nbsp;${h}&nbsp;&zwnj;&nbsp;${r}`)}else this._date.html("---")}getWindDirection(t){if(t){const e=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"];let i;switch(!0){case t<22.5||360===t:i=e[0];break;case t>=22.5&&t<45:i=e[1];break;case t>=45&&t<67.5:i=e[2];break;case t>=67.5&&t<90:i=e[3];break;case t>=90&&t<112.5:i=e[4];break;case t>=112.5&&t<135:i=e[5];break;case t>=135&&t<157.5:i=e[6];break;case t>=157.5&&t<180:i=e[7];break;case t>=180&&t<202.5:i=e[8];break;case t>=202.5&&t<225:i=e[9];break;case t>=225&&t<247.5:i=e[10];break;case t>=247.5&&t<270:i=e[11];break;case t>=270&&t<292.5:i=e[12];break;case t>=292.5&&t<315:i=e[13];break;case t>=315&&t<337.5:i=e[14];break;case t>=337.5&&t<360:i=e[15]}this._windDirection.html(`${i} (${t}&#176;)`)}else this._windDirection.html("---")}displayData(t){t?(this.displayDate(t),this.getWindDirection(t.wind.deg),this._city.html(this.city),this._city.css("color","#fff"),this._humidity.html(`${t.main.humidity}%`),this._pressure.html(`${t.main.pressure} hPa`),this._windSpeed.html(`${t.wind.speed} km/h`),this._icon.attr("src",`../src/images/${t.weather[0].icon}.svg`),this._desc.html(t.weather[0].description),this._temp.html(`${Math.round(t.main.temp)}&#8451;`),this._feelsLike.html(`${Math.round(t.main.feels_like)}&#8451;`)):(this.displayDate(t),this.getWindDirection(t),this._city.css("color","#fff"),this._humidity.html("---"),this._pressure.html("---"),this._windSpeed.html("---"),this._icon.attr("src","../src/images/not_found.svg"),this._desc.html("---"),this._temp.html("---"),this._feelsLike.html("---"))}}$(document).ready((function(){new t({_date:$(".js--weather__date"),_humidity:$(".js--weather__humidity"),_pressure:$(".js--weather__pressure"),_windSpeed:$(".js--weather__wind-speed"),_windDirection:$(".js--weather__wind-dir"),_icon:$(".js--weather__icon"),_temp:$(".js--weather__temp"),_feelsLike:$(".js--weather__feels-like"),_desc:$(".js--weather__desc"),_city:$(".js--weather__city"),_cityForm:$(".js--city-form"),_preloader:$(".js--preloader"),_localStorageKeyName:"usersCity"}).init()}))})()})();